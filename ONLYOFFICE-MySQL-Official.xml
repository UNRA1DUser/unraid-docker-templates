<?xml version="1.0"?>
<Container version="2">
  <Name>ONLYOFFICE-MySQL-Official</Name>
  <Repository>mysql:5.7</Repository>
  <Registry>https://hub.docker.com/_/mysql</Registry>
  <Network>onlyoffice</Network>
  <MyIP/>
  <Shell>sh</Shell>
  <Privileged>false</Privileged>
  <Support>https://forums.unraid.net/topic/150912-support-unra1duser-mysql-official/</Support>
  <Project>https://www.onlyoffice.com/</Project>
  <Overview>Official MySQL database container configured with the Instructions from ONLYOFFICE!&#xD;
&#xD;
#Root Password:&#xD;
This container creates by default a random root password on initial execution. Open Docker &amp;gt; MariaDB Icon &amp;gt; Logs &amp;gt; Scroll down to "GENERATED ROOT PASSWORD" to find it.&#xD;
&#xD;
#Configuration without a cnf file&#xD;
All needed configuration options for ONLYOFFICE-MySQL are passed as flags to mysqld via Post Arguments.&#xD;
&#xD;
mysqld --log-error=/var/log/mysql/error.log --sql-mode=NO_ENGINE_SUBSTITUTION --max-connections=1000 --max-allowed-packet=1048576000 --group-concat-max-len=2048&#xD;
&#xD;
#Creating database dumps&#xD;
docker exec some-mysql sh -c 'exec mysqldump --all-databases -uroot -p"$MYSQL_ROOT_PASSWORD"' &amp;gt; /mnt/user/Backups/all-databases.sql&#xD;
&#xD;
#Restoring data from dump files&#xD;
docker exec -i some-mysql sh -c 'exec mysql -uroot -p"$MYSQL_ROOT_PASSWORD"' &amp;lt; /mnt/user/Backups/all-databases.sql</Overview>
  <Category>Other: Network:Other</Category>
  <WebUI/>
  <TemplateURL/>
  <Icon>https://raw.githubusercontent.com/UNRA1DUser/unraid-docker-templates/main/UNRA1DUser/images/library-mysql-logo.png</Icon>
  <ExtraParams>--user=99:100 --memory=2G --restart=unless-stopped</ExtraParams>
  <PostArgs>mysqld --log-error=/var/log/mysql/error.log --sql-mode=NO_ENGINE_SUBSTITUTION --max-connections=1000 --max-allowed-packet=1048576000 --group-concat-max-len=2048</PostArgs>
  <CPUset/>
  <DateInstalled>1704808736</DateInstalled>
  <DonateText>If you like my work and would like to support me please consider Donating.</DonateText>
  <DonateLink>paypal.me/M4rc31</DonateLink>
  <Requires>#Before you start this Docker the first time&#xD;
&#xD;
Create the ONLYOFFICE network (Open the Terminal from the Unraid Website and execute that command):&#xD;
&#xD;
sudo docker network create --driver bridge onlyoffice&#xD;
&#xD;
#After you started this Docker the first time&#xD;
&#xD;
Login with the root user and the generated password to mysql via phpMyAdmin. Click on SQL and run this Query to create some users with the right permissions. (Please don&#xB4;t forget to change the passwords!)&#xD;
&#xD;
CREATE USER 'onlyoffice_user'@'localhost' IDENTIFIED BY 'onlyoffice_pass';&#xD;
CREATE USER 'mail_admin'@'localhost' IDENTIFIED BY 'Isadmin123';&#xD;
GRANT ALL PRIVILEGES ON * . * TO 'onlyoffice_user'@'%' IDENTIFIED BY 'onlyoffice_pass';&#xD;
GRANT ALL PRIVILEGES ON * . * TO 'mail_admin'@'%' IDENTIFIED BY 'Isadmin123';&#xD;
FLUSH PRIVILEGES;&#xD;
&#xD;
The onlyoffice_user is required for ONLYOFFICE Community Server, and the mail_admin is required for ONLYOFFICE Mail Server in case it is going to be installed.&#xD;
Please note, that the above script will set permissions to access SQL server from any domains (%). If you want to limit the access, you can specify hosts which will have access to SQL server.</Requires>
  <Config Name="MYSQL_TCP_PORT" Target="3306" Default="3306" Mode="tcp" Description="MYSQL_TCP_PORT" Type="Port" Display="always" Required="true" Mask="false"/>
  <Config Name="Generate Random Password" Target="MYSQL_RANDOM_ROOT_PASSWORD" Default="yes" Mode="" Description="Set to yes, to generate a random root password. The generated password will be printed to the logs (Docker &amp;gt; MySQL Icon &amp;gt; Logs)." Type="Variable" Display="always" Required="true" Mask="false"/>
  <Config Name="Database Name" Target="MYSQL_DATABASE" Default="onlyoffice" Mode="" Description="This variable allows you to specify the name of a database to be created on image startup." Type="Variable" Display="always" Required="true" Mask="false"/>
  <Config Name="Data" Target="/var/lib/mysql" Default="/mnt/user/appdata/onlyoffice-official/onlyoffice-mysql-official/data" Mode="rw" Description="Recommened: For better performance replace /mnt/user against /mnt/cache. Note: This requires appdata share caching set to Prefer or Only!" Type="Path" Display="always" Required="true" Mask="false"/>
  <Config Name="Logs" Target="/var/log/mysql" Default="/mnt/user/appdata/onlyoffice-official/onlyoffice-mysql-official/logs" Mode="rw" Description="" Type="Path" Display="always" Required="true" Mask="false"/>
</Container>
